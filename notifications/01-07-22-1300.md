**What is happening?**

Currently network traffic leaving the OpenShift clusters is mapped to a single NAT IP. This will be expanded to 4 IPs used in round robin. Existing firewall rules will be updated to match the new set of IPs, which will allow the existing firewall fules for **all existing connections between the Openshift clusters and other components within the BC Government network to continue functioning without any other changes required**.

**Why is it happening?**

When performing egress NAT from the clusters, a mapping table needs to be made on the NAT device (F5) to track which outgoing IP:Port pair maps to which connection being NATed. We currently only have one IP for egress, and there are only 64k ports in TCP/UDP. In our busiest cluster we are currently peaking usage around half the available ports and have had alerts in the past of port exhaustion. When the NAT runs out of ports for mappings, egress connections will fail.

We are expanding the NAT pool to have additional IPs to allow for more capacity and resiliency in NAT egress traffic.

**When is it happening?**

- Jan 17th 19:30 the SiS Firewall will be updated with the new IPs to allow traffic to the public internet
- Jan 18th 19:30 the DMZ, General, and Sector firewalls in Interior and Calgary will have the Network Object changed to have the additional IPs for SILVER cluster
- Jan 19th 19:30 the DMZ, General, and Sector firewalls in Interior and Calgary will have the Network Object changed to have the additional IPs for GOLD and GOLDDR clusters
- Jan 23rd 06:00 the SILVER F5 will have its NAT pool adjusted to use the additional IPs
- Jan 30th 06:00 the GOLD F5 will have its NAT pool adjusted to use the additional IPs
- Feb 6th 06:00 the GOLDDR F5 will have its NAT pool adjusted to use the additional IPs

**Do I need to do anything?**

No action from dev teams is required, however it would be good to test your apps during the change windows to ensure everything goes smoothly.

**Check the #devops-alert channel for the announcement of when the change is complete and check the health of your app.**

**Where do I get help if my app doesn't work after the change is complete?**

Each Platform application has an assigned DevOps Specialist within the Ministry so contact them first. If you don't know who your assigned DevOps Specialist, check with the app's Product Owner.

The DevOps Specialist will troubleshoot the issue with the app and if they need help, they will reach out to the Platform Services Team and the Developer Community in Rocket.Chat as per these [RocketChat Channel Use Guidelines](
https://developer.gov.bc.ca/Getting-human-support-for-issues-not-covered-by-devops-requests).
